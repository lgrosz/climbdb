BEGIN;

SELECT plan(27);

-- image features

SELECT has_table( 'topo_image_features' );

SELECT has_column( 'topo_image_features', 'id' );
SELECT col_is_pk( 'topo_image_features', 'id' );
SELECT col_type_is( 'topo_image_features', 'id', 'integer' );

SELECT has_column( 'topo_image_features', 'source_crop' );
SELECT col_type_is( 'topo_image_features', 'source_crop', 'box' );

SELECT has_column( 'topo_image_features', 'dest_crop' );
SELECT col_type_is( 'topo_image_features', 'dest_crop', 'box' );
SELECT col_not_null( 'topo_image_features', 'dest_crop' );

SELECT has_column( 'topo_image_features', 'image_id' );
SELECT col_type_is( 'topo_image_features', 'image_id', 'integer' );
SELECT fk_ok( 'topo_image_features', 'image_id', 'images', 'id' );

SELECT has_column( 'topo_image_features', 'topo_id' );
SELECT col_type_is( 'topo_image_features', 'topo_id', 'integer' );
SELECT fk_ok( 'topo_image_features', 'topo_id', 'topos', 'id' );

-- path features

SELECT has_table( 'topo_path_features' );

SELECT has_column( 'topo_path_features', 'id' );
SELECT col_is_pk( 'topo_path_features', 'id' );
SELECT col_type_is( 'topo_path_features', 'id', 'integer' );

SELECT has_column( 'topo_path_features', 'geometry' );
SELECT col_type_is( 'topo_path_features', 'geometry', 'basis_spline' );

SELECT has_column( 'topo_path_features', 'climb_id' );
SELECT col_type_is( 'topo_path_features', 'climb_id', 'integer' );
SELECT fk_ok( 'topo_path_features', 'climb_id', 'climbs', 'id' );

SELECT has_column( 'topo_path_features', 'topo_id' );
SELECT col_type_is( 'topo_path_features', 'topo_id', 'integer' );
SELECT fk_ok( 'topo_path_features', 'topo_id', 'topos', 'id' );

SELECT * FROM finish();

ROLLBACK;
