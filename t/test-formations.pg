BEGIN;
SELECT plan(8);

SELECT has_table( 'formations', 'Has formation table' );

SELECT has_column( 'formations', 'id', 'Formation table has id column' );
SELECT col_is_pk( 'formations', 'id', 'Formation table id column is primary key' );
SELECT col_not_null( 'formations', 'id', 'Formation table id column is not null' );

SELECT has_column( 'formations', 'name', 'Formation table has name column' );
SELECT col_has_check( 'formations', 'name', 'Formation table name column has check constraint' );

PREPARE insert_formation_with_empty_name AS INSERT INTO formations (name) VALUES ('');
SELECT throws_ok(
    'insert_formation_with_empty_name',
    '23514',
    'new row for relation "formations" violates check constraint "formations_name_check"',
    'Cannot insert formation with empty name'
);

SELECT has_column( 'formations', 'location', 'Formation table has location column' );

SELECT * FROM finish();
ROLLBACK;
